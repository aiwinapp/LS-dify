# Frontend README

## Общая структура проекта

Этот проект представляет собой веб-приложение, построенное с использованием фреймворка Next.js и библиотеки React. Он следует архитектурному подходу "файлы как компоненты" (File-based Routing), который является одной из ключевых особенностей Next.js. Это означает, что каждый файл в директории `app/` соответствует определенному маршруту в приложении.

Проект использует концепцию "лейаутов" (Layouts) для организации общей структуры страниц. Существуют два основных лейаута: `(commonLayout)` и `(shareLayout)`. Первый используется для страниц, требующих аутентификации, а второй - для общедоступных страниц, таких как страница входа.

## Основные компоненты и директории

### `app/components/`

Здесь находятся все компоненты React, используемые в приложении. Они разделены на несколько подкаталогов в соответствии с их назначением:

- `base/`: Базовые компоненты, такие как кнопки, модальные окна, поля ввода и т.д.
- `header/`: Компоненты, связанные с заголовком и навигацией.
- `chat/`: Компоненты, связанные с чатом и историей сообщений.
- `channel/`: Компоненты, связанные с каналами (Telegram, WhatsApp и т.д.).

### `app/(commonLayout)/`

Здесь находятся страницы, требующие аутентификации. Например, страница "Studio" (`app/(commonLayout)/studio/page.tsx`) и страница "Channels" (`app/(commonLayout)/channels/page.tsx`).

### `app/(shareLayout)/`

Здесь находятся общедоступные страницы, такие как страница входа (`app/(shareLayout)/login/page.tsx`) и страница чата (`app/(shareLayout)/chat/[token]/page.tsx`).

### `context/`

Здесь определены контексты React, используемые для управления глобальным состоянием приложения.

### `hooks/`

Здесь находятся пользовательские хуки React, используемые в различных компонентах.

### `models/`

Здесь определены интерфейсы и типы данных, используемые в приложении.

### `service/`

Здесь находятся функции для взаимодействия с API-сервером.

### `utils/`

Здесь находятся вспомогательные функции и утилиты, используемые в различных частях приложения.

## Основные библиотеки и зависимости

- `react` и `react-dom`: Основные библиотеки React.
- `next`: Фреймворк Next.js для создания серверно-рендеренных React-приложений.
- `swr`: Библиотека для управления состоянием и кэшированием данных, полученных из API.
- `zustand`: Библиотека для управления глобальным состоянием приложения.
- `i18next`: Библиотека для локализации и интернационализации.
- `tailwindcss`: Утилитарный CSS-фреймворк для стилизации компонентов.
- `lodash-es`: Библиотека вспомогательных функций для работы с массивами, объектами и другими структурами данных.

## Основные концепции и паттерны

- **Контекст React**: Используется для управления глобальным состоянием приложения, таким как информация о текущем пользователе, рабочем пространстве и т.д.
- **Хуки React**: Используются для инкапсуляции логики и повторного использования кода в компонентах.
- **Zustand**: Библиотека для управления глобальным состоянием, используемая для хранения и обновления состояния каналов.
- **SWR**: Библиотека для управления состоянием и кэшированием данных, полученных из API. Используется для получения списка каналов и других данных.
- **Локализация и интернационализация**: Приложение поддерживает несколько языков, и для этого используется библиотека `i18next`.
- **Стили и Tailwind CSS**: Для стилизации компонентов используется утилитарный CSS-фреймворк Tailwind CSS.

## Серверная часть и взаимодействие с API

Хотя в этом проекте нет серверной части, предполагается, что приложение взаимодействует с API-сервером для получения и отправки данных. Функции для взаимодействия с API находятся в директории `service/`. Например, `service/channels.ts` содержит функции `fetchChannelList` и `createChannel` для получения списка каналов и создания нового канала соответственно.

Эти функции используют вспомогательную функцию `fetcher` из `utils/fetcher.ts`, которая обертывает стандартный `fetch` API и добавляет дополнительную обработку ошибок и авторизацию (если необходимо).

## Дальнейшее развитие и масштабирование

Текущая структура проекта позволяет легко добавлять новые страницы и компоненты, следуя существующим паттернам и концепциям. Для масштабирования и дальнейшего развития проекта можно рассмотреть следующие возможности:

- **Серверный рендеринг**: Next.js поддерживает серверный рендеринг, что может улучшить производительность и SEO для определенных страниц.
- **Статическая генерация**: Некоторые страницы могут быть статически сгенерированы на этапе сборки для улучшения производительности.
- **Модульная структура**: По мере роста проекта, можно рассмотреть возможность разделения его на модули или микросервисы для лучшей масштабируемости и поддержки.
- **Тестирование**: Добавление юнит-тестов, тестов компонентов и интеграционных тестов для обеспечения качества и стабильности кода.
- **Мониторинг и логирование**: Внедрение системы мониторинга и логирования для отслеживания производительности и выявления ошибок.
- **Безопасность**: Регулярный аудит безопасности и внедрение лучших практик для защиты приложения от уязвимостей.

## Типы каналов

Приложение поддерживает следующие типы каналов:

### Telegram (API Bot Token)

Для создания канала этого типа необходимо предоставить API Bot Token от Telegram. Взаимодействие с Telegram осуществляется через библиотеку `node-telegram-bot-api`.

### Telegram Premium (Personal Account + BOT)

Для создания канала этого типа необходимо предоставить номер телефона личного аккаунта Telegram и API Bot Token. Взаимодействие с Telegram осуществляется через библиотеку `node-telegram-bot-api` и личный аккаунт пользователя.

### WhatsApp

Для создания канала этого типа необходимо предоставить номер телефона, привязанный к WhatsApp. Взаимодействие с WhatsApp осуществляется через библиотеку `whatsapp-web.js`.

## Создание нового канала

Для создания нового канала используется компонент `CreateChannelModal` из `app/components/channel/create-channel-modal.tsx`. В этом модальном окне пользователь может выбрать тип канала, ввести необходимую конфигурацию (API Bot Token, номер телефона и т.д.) и создать новый канал.

После создания канала, его детали сохраняются в хранилище состояния `useStore` из `app/components/channel/store.ts`, а также отправляются на сервер через функцию `createChannel` из `service/channels.ts`.

## Страница "Channels"

Страница "Channels" (`app/(commonLayout)/channels/page.tsx`) отображает список существующих каналов и позволяет создавать новые каналы. Она использует компонент `Nav` для навигации и компонент `CreateChannelModal` для создания новых каналов.

Список каналов получается из API-сервера через функцию `fetchChannelList` из `service/channels.ts` и отображается с помощью компонента `Nav`. При выборе канала его детали сохраняются в хранилище состояния `useStore`.

## Локализация и интернационализация

Приложение поддерживает несколько языков, и для этого используется библиотека `i18next`. Строки перевода находятся в файлах локализации, расположенных в директории `public/locales/`.

Для использования переведенных строк в компонентах используется хук `useTranslation` из `react-i18next`. Например:
jsx
import { useTranslation } from 'react-i18next'
const MyComponent = () => {
const { t } = useTranslation()
return <div>{t('common.hello')}</div>
}


## Стили и Tailwind CSS

Для стилизации компонентов используется утилитарный CSS-фреймворк Tailwind CSS. Файлы стилей находятся в директории `styles/`.

Компоненты стилизуются с помощью классов Tailwind CSS, которые применяются непосредственно в JSX-разметке. Например:
jsx
<button className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
Click me
</button>


## Дополнительные ресурсы

- [Документация Next.js](https://nextjs.org/docs)
- [Документация React](https://reactjs.org/docs/getting-started.html)
- [Документация SWR](https://swr.vercel.app/docs/getting-started)
- [Документация Zustand](https://github.com/pmndrs/zustand)
- [Документация i18next](https://www.i18next.com/overview/getting-started)
- [Документация Tailwind CSS](https://tailwindcss.com/docs/installation)
- [Документация Lodash](https://lodash.com/docs/4.17.15)